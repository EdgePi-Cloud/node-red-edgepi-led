<script type="text/javascript">
    RED.nodes.registerType('edgepi-led-node',{
        category: 'Osensa EdgePi',
        color: '#a6bbcf',
        defaults: {
            name: { value:"" },
            ConfigStyle: { value: "Editor" },
            Method: { value: "toggleLed"},
            LedPin: { value: "LED1" }
        },
        inputs:1,
        outputs:1,
        icon: "light.svg",
        label: function() {
            return this.name||"edgepi-led-node";
        },
        oneditprepare: function(){
            // Query html elements
            const configStyleSelect = document.getElementById("node-input-ConfigStyle");
            const methodRow = document.querySelector(".form-row.Method");
            const ledPinRow = document.querySelector(".form-row.LEDPin");
            const receiveInputInfo = document.querySelector(".ReceiveInput-INFO-Container")

            function updateEditor(){
                if (configStyleSelect.value === "Editor") {
                    methodRow.style.display = "block";
                    ledPinRow.style.display = "block";
                    receiveInputInfo.style.display = "none";
                } else {
                    methodRow.style.display = "none";
                    ledPinRow.style.display = "none";
                    receiveInputInfo.style.display = "block"
                }
            }
            // Update and add event listener to update on user input
            updateEditor()
            configStyleSelect.addEventListener("change", updateEditor);
        }
    });
</script>

<script type="text/html" data-template-name="edgepi-led-node">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row ConfigStyle" style="display: flex; flex-direction: row;">
        <label for="node-input-ConfigStyle">Configuration style: </label>
        <select id="node-input-ConfigStyle">
          <option value="Editor">Editor</option>
          <option value="ReceiveInput">Receive input</option>
        </select>
      </div>
    <div class="ReceiveInput-INFO-Container" style="display: none;">
        <p class="ReceiveInput-INFO" style="background-color: #d8d8d8; padding: 5px !important; border-radius: 3px;">
            Input received from messages will trigger an LED method based off of the method and arguments supplied. To correctly trigger an LED
            method, the message received muse be in JSON format, specifying the method name and arguments. For example, the following
            would be valid: {"Method": "toggleLed", "LedPin": "LED1"}
        </p>
    </div>
    <div class="form-row Method">
        <label for="node-input-Method">Method</label>
        <select id="node-input-Method">
          <option value="toggleLed">toggleLed</option>
          <option value="turnOn">turnOn</option>
          <option value="turnOff">turnOff</option>

        </select>
      </div>
    <div class="form-row LEDPin">
        <label for="node-input-LedPin">Pin</label>
        <select id="node-input-LedPin">
          <option value="LED1">LED1</option>
          <option value="LED2">LED2</option>
          <option value="LED3">LED3</option>
          <option value="LED4">LED4</option>
          <option value="LED5">LED5</option>
          <option value="LED6">LED6</option>
          <option value="LED7">LED7</option>
          <option value="LED8">LED8</option>
        </select>
      </div>
</script>



<script type="text/html" data-help-name="edgepi-led-node">
    <p>Node for EdgePi LED array.</p>
</script>
